{"version":3,"sources":["global.js","model.js","mapUtil.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACviBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"utils.js","sourcesContent":["/*\r\n * global.js\r\n * Jessie Sanford\r\n */\r\n\r\nfunction reloadScripts()\r\n{\r\n    var head = document.getElementsByTagName('head')[0];\r\n    var appScript = head.getElementById('js-app');\r\n\thead.removeChild(appScript);\r\n    var script = document.createElement('script');\r\n    script.type = 'text/javascript';\r\n    script.src = './js/app.js';\r\n    script.id = 'js-app';\r\n    head.appendChild(script);\r\n}\r\n\r\nfunction handleError(resp) {\r\n    var w = window.open('about:blank', 'windowname');\r\n    w.document.write(resp.responseText);\r\n    w.document.close();\r\n};\r\n\r\nfunction popup(text)\r\n{\r\n\tif ( $('.popup').is(':visible') )\r\n\t{\r\n\t\t$('.popup').hide();\r\n\t}\r\n\t$('.popup span').html(text);\r\n\t$('.popup').fadeIn(200);\r\n\r\n\tsetTimeout(function(){\r\n\t\t$('.popup').fadeOut(200);\r\n\t}, 4000);\r\n}\r\n\r\nfunction generateError(data) {\r\n\tconsole.log(data);\r\n\tvar w = window.open('about:blank', 'windowname');\r\n\tw.document.write(data.responseText);\r\n\tw.document.close();\r\n}\r\n\r\nfunction loadingStart() {\r\n    $('#loading').show();\r\n}\r\n\r\nfunction loadingEnd() {\r\n\t$('#loading').fadeOut(200);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction model_create(content, frozen, classes)\r\n{\r\n\tif ( $('#model').is(':visible') )\r\n\t{\r\n\t\t$('#model').removeClass('fade_in');\r\n\t}\r\n\t$('#model').html(content);\r\n\t$('#model').addClass(classes);\r\n\t$('#model').css(\"top\", 0.5 * $(window).height() - ($('#model').height() / 2));\r\n\t$('#mask, #model').addClass('fade_in');\r\n\tif ( frozen == true)\r\n\t{\r\n\t\t$('#model').addClass('frozen');\r\n\t}\r\n}\r\n\r\nfunction model_destroy()\r\n{\r\n\t$('#model, #mask').removeClass('fade_in');\r\n}\r\n\r\nfunction model_repos()\r\n{\r\n\t$('#model').css(\"top\", 0.5 * $(window).height() - ($('#model').height() / 2));\r\n}\r\n\r\n\r\n$(document).ready(function() {\r\n\r\n\t// this should be implemented better\r\n    $.fn.serializeObject = function()\r\n    {\r\n        var o = {};\r\n        var a = this.serializeArray();\r\n        $.each(a, function() {\r\n            if (o[this.name] !== undefined) {\r\n                if (!o[this.name].push) {\r\n                    o[this.name] = [o[this.name]];\r\n                }\r\n                o[this.name].push(this.value || '');\r\n            } else {\r\n                o[this.name] = this.value || '';\r\n            }\r\n        });\r\n        return o;\r\n    };\r\n\r\n\tshowLoad = true;\r\n\r\n\t/*\r\n\t\tRight, so Laravel is fucking stupid and keeps changing the current session csrf token which causes AJAX posts\r\n\t\tto randomly fucking fail because the keys don't match in the back end. The only solution I can seem to find is\r\n\t\tgrab the corresponding meta tag for the csrf token by refreshing the page and grabbing that value instead.\r\n\t*/\r\n\r\n\t//$.ajaxPrefilter(function(options) {\r\n\t//\tif (!options.beforeSend && options.type.toUpperCase() == 'POST') {\r\n\t//\t\toptions.beforeSend = function (xhr) {\r\n\t//\t\t\tgetCSRF_ss(function(token) {\r\n\t//\t\t\t\txhr.setRequestHeader('X-CSRF-TOKEN', token);\r\n\t//\t\t\t});\r\n\t//\t\t}\r\n\t//\t}\r\n\t//});\r\n\r\n\tfunction getCSRF(callback) {\r\n\t\t$.get(location.href, function(response) {\r\n\t\t\tvar tempDom = $('<div>').append($.parseHTML(response));\r\n\t\t\tvar token = $('meta[name=\"csrf-token\"]', tempDom).attr('content');\r\n\r\n\t\t\t$.ajaxSetup({\r\n\t\t\t\theaders: {'X-CSRF-TOKEN': token}\r\n\t\t\t});\r\n\t\t\tcallback(token);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getCSRF_ss(callback) {\r\n\t\t$.get('/refresh-csrf', function( data ) {\r\n\t\t\tcallback(data);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\t$.ajaxSetup({\r\n\t\theaders: { 'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content') }\r\n\t});\r\n\r\n\t//$(document).ajaxError(function(event, request, settings) {\r\n\t//\tgetCSRF(function(token) {\r\n\t//\t\tsettings.headers['X-CSRF-TOKEN'] = token;\r\n\t//\t\t//settings.data['_token'] = token;\r\n\t//\t\t//$.ajax(settings);\r\n\t//\t});\r\n    //\r\n\t//});\r\n\r\n\r\n\t$(document).ajaxComplete(function(event, request, settings) {\r\n\t\tif (settings.type.toUpperCase() == 'POST') {\r\n\t\t\tgetCSRF_ss(function(token) {\r\n\t\t\t\tif (token != $('meta[name=\"csrf-token\"]').attr('content')) {\r\n\t\t\t\t\t$('meta[name=\"csrf-token\"]').attr('content', token);\r\n\t\t\t\t\t$.ajaxSetup({\r\n\t\t\t\t\t\theaders: { 'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content') }\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\r\n\t//setInterval(function(){\r\n\t//\tshowLoad = false;\r\n\t//\tgetCSRF_ss(function(token) {\r\n\t//\t\tconsole.log('TOKEN: ' + token);\r\n\t//\t});\r\n\t//}, 3000);\r\n\r\n\r\n\t// $(document).ajaxStart(function () {\r\n\t// \tloadingStart();\r\n\t// });\r\n\t$(document).ajaxStop(function () {\r\n\t\tloadingEnd();\r\n\t});\r\n\r\n\r\n\r\n\t$(document).on('click', '.popup', function (e) {\r\n\t\t// if ($(e.target).closest('.popup').length === 0) {\r\n\t\t\t$('.popup').hide();\r\n\t\t// }\r\n\t});\r\n\r\n\r\n\t// MAIN SIDEBAR FUNCTIONALITY (OPEN/CLOSE)\r\n\t$(document).click(function (e) {\r\n\t\tif ($(e.target).closest('.toggle-main-sidebar, #main-sidebar').length === 0 && $('#main-sidebar').hasClass('visible')) {\r\n\t\t\ttoggleMainSidebar(e);\r\n\t\t}\r\n\t});\r\n\r\n\t$('.toggle-main-sidebar').on('touchstart click', function (e) {\r\n\t\ttoggleMainSidebar(e);\r\n\t});\r\n\r\n\tfunction toggleMainSidebar(e) {\r\n\t\te.preventDefault();\r\n\t\tvar slideview = $('#main-sidebar');\r\n\r\n\t\t// slideview is not visible, make visible and add visible class\r\n\t\tif (!slideview.hasClass('visible')) {\r\n\t\t\tslideview.addClass('visible');\r\n\t\t\tslideview.addClass('animating left');\r\n\t\t}\r\n\t\t// slideview is visible, hide and remove visible class\r\n\t\telse {\r\n\t\t\tslideview.removeClass('visible');\r\n\t\t\tslideview.removeClass('animating left');\r\n\t\t}\r\n\r\n\t}\r\n\r\n// ADMIN SIDEBAR FUNCTIONALITY (OPEN/CLOSE)\r\n\t$(document).click(function (e) {\r\n\t\tif ($(e.target).closest('.toggle-admin-sidebar, #admin-sidebar').length === 0 && $('#admin-sidebar').hasClass('visible')) {\r\n\t\t\ttoggleAdminSidebar(e);\r\n\t\t}\r\n\t});\r\n\r\n\t$('.toggle-admin-sidebar').on('touchstart click', function (e) {\r\n\t\ttoggleAdminSidebar(e);\r\n\t});\r\n\r\n\tfunction toggleAdminSidebar(e) {\r\n\t\te.preventDefault();\r\n\t\tvar slideview = $('#admin-sidebar');\r\n\r\n\t\t// slideview is not visible, make visible and add visible class\r\n\t\tif (!slideview.hasClass('visible')) {\r\n\t\t\tslideview.addClass('visible');\r\n\t\t\tslideview.addClass('animating left');\r\n\t\t}\r\n\t\t// slideview is visible, hide and remove visible class\r\n\t\telse {\r\n\t\t\tslideview.removeClass('visible');\r\n\t\t\tslideview.removeClass('animating left');\r\n\t\t}\r\n\r\n\t};\r\n\r\n\r\n\t$(document).on('submit', '#contact_form', function () {\r\n\t\tform = $(this);\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: \"controllers/misc.php\",\r\n\t\t\tdata: form.serialize() + \"&action=submit_contact\",\r\n\t\t\tdataType: \"json\",\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\t$('#contact_form input[type=submit]').prop('disabled', true);\r\n\t\t\t\tif (data.form_check == 'error') {\r\n\t\t\t\t\t$('#contact_form input[type=submit]').prop('disabled', false);\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t\t$('#contact_form')[0].reset();\r\n\t\t\t\t\t$(this).children('input[type=submit]').prop('disabled', true);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (xhr, ajaxOptions, thrownError) {\r\n\t\t\t\tpopup(xhr.status + thrownError);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn false;\r\n\t});\r\n\r\n// global component\r\n\t$(document).on('click', 'ul.tab-menu li', function (e) {\r\n\t\t$('ul.tab-menu li').removeClass('selected');\r\n\t\t$(this).addClass('selected');\r\n\t\t$('.tab-panel').removeClass('tab-current');\r\n\t\t$('#' + $(this).attr('data')).addClass('tab-current');\r\n\t});\r\n\r\n\r\n\r\n\r\n\t$(document).on('submit', '#forgot_password', function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\tvar form_data = $(this).serialize();\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: \"./controllers/user.php\",\r\n\t\t\tdata: form_data + \"&action=user_forgot_password\",\r\n\t\t\tdataType: 'json',\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (data.form_check == 'error') {\r\n\t\t\t\t\tconsole.log(data);\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t\t$('input[name=' + data.error_source + ']').addClass('form_error');\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t\t// window.location.href = './user?action=login';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (xhr, ajaxOptions, thrownError) {\r\n\t\t\t\tconsole.log(xhr.responseText + thrownError);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\r\n// registration scripts ---------------------------------------------\r\n\r\n\t$('#phone').keydown(function (e) {\r\n\t\tif ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||\r\n\t\t\t\t// Allow: Ctrl+A\r\n\t\t\t(e.keyCode == 65 && e.ctrlKey === true) ||\r\n\t\t\t\t// Allow: Ctrl+C\r\n\t\t\t(e.keyCode == 67 && e.ctrlKey === true) ||\r\n\t\t\t\t// Allow: Ctrl+X\r\n\t\t\t(e.keyCode == 88 && e.ctrlKey === true) ||\r\n\t\t\t\t// Allow: home, end, left, right\r\n\t\t\t(e.keyCode >= 35 && e.keyCode <= 39)) {\r\n\t\t\t// let it happen, don't do anything\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// Ensure that it is a number and stop the keypress\r\n\t\tif ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\tvar foo = $(this).val().split(\"-\").join(\"\"); // remove hyphens\r\n\t\tfoo = foo.match(new RegExp('.{1,4}$|.{1,3}', 'g')).join(\"-\");\r\n\t\t$(this).val(foo);\r\n\t});\r\n\r\n\r\n\t$('#register_form').submit(function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\t$('.form_error').removeClass('form_error');\r\n\t\tform_data = $(this).serialize();\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: \"./user/register\",\r\n\t\t\tdata: form_data,\r\n\t\t\tdataType: 'json',\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tif (data.errors != undefined) {\r\n\t\t\t\t\tpopup(data.errors[Object.keys(data.errors)[0]]);\r\n\t\t\t\t\tfor (key in data.errors) {\r\n\t\t\t\t\t\t$('#' + key).addClass('form_error');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tga('send', 'event', 'functions', 'register', 'register', '1');\r\n\t\t\t\t\t$('.form_error').removeClass('form_error');\r\n\t\t\t\t\t$('#register_form')[0].reset();\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\twindow.location.href = './user/verify';\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror: function (data) {\r\n\t\t\t\tgenerateError(data);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn false;\r\n\t});\r\n\r\n\t$('#verif_form').submit(function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\t$.post('./controllers/user.php', $('#verif_form').serialize() + \"&action=user_verify\",\r\n\t\t\tfunction (data) {\r\n\t\t\t\tif (data.form_check == 'error') {\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t\tfor (key in data.error_source) {\r\n\t\t\t\t\t\t$('#' + data.error_source).addClass('form_error');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t$('.form_error').removeClass('form_error');\r\n\t\t\t\t\t$('#verif_form')[0].reset();\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t\twindow.location.href = './';\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 'json');\r\n\t\treturn false;\r\n\t});\r\n\r\n\t$(document).on('click', '#resend_verif_code', function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\t$.post('./controllers/user.php', \"action=user_resend_verif\",\r\n\t\t\tfunction (data) {\r\n\t\t\t\tpopup(data.alert);\r\n\t\t\t}, 'json');\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\t$(document).on('click', '.form_error, .form-error', function (e) {\r\n\t\t$(this).removeClass('form_error form-error');\r\n\t});\r\n\r\n\t$(document).on('submit', 'form', function (e) {\r\n\t\t$('form_error').removeClass('form_error');\r\n\t});\r\n\r\n\r\n\t$(document).on('click', \"#user_logout\", function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: \"/user/logout\",\r\n\t\t\tdataType: 'json',\r\n\t\t\tsuccess: function (data) {\r\n\t\t\t\tpopup(data.alert);\r\n\t\t\t\twindow.location.href = \"/\";\r\n\t\t\t},\r\n\t\t\terror: function (data) {\r\n\t\t\t\tgenerateError(data);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\r\n// driver app js submit\r\n\t$(document).on('submit', '#driver_app', function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\t$.post('./controllers/misc.php', $('#driver_app').serialize() + '&action=submit_driver_app',\r\n\t\t\tfunction (data) {\r\n\t\t\t\tif (data.form_check == 'error') {\r\n\t\t\t\t\t$('input[name=' + data.error_source + ']').addClass('form_error');\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tpopup(data.alert);\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 'json');\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\r\n\t$(document).on('click', '.confirm-action', function (e) {\r\n\t\te.preventDefault();\r\n\r\n\t\tvar desc = $(this).attr('data-desc');\r\n\t\tvar value = $(this).attr('data-value');\r\n\t\tvar action = $(this).attr('data-action');\r\n\t\tvar buttonText = $(this).attr('data-button');\r\n\r\n\t\tvar content = '<div class=\"push-bottom-10\">' + $(this).attr('data-desc') + '</div>';\r\n\r\n\t\tvar modal = new Modal('Confirm Action', null);\r\n\t\tmodal.setContent(content);\r\n\t\tmodal.submitButton.innerText = buttonText;\r\n\t\tmodal.submitButton.className = modal.submitButton.className + \" \" + action;\r\n\t\tmodal.submitButton.dataset.value = value;\r\n\t\tmodal.setVisible();\r\n\r\n\t\tmodal.setSubmitAction(function() {\r\n\t\t\tthis.destroy();\r\n\t\t});\r\n\r\n\t});\r\n\r\n\tif (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\r\n\t\t$(\"input.textbox, textarea\").click(function () {\r\n\t\t\telement = $(this);\r\n\t\t\t$('html, body').animate({\r\n\t\t\t\tscrollTop: element.offset().top - 40\r\n\t\t\t}, 400);\r\n\t\t});\r\n\t}\r\n\r\n\t// handle header login btn click\r\n\t$(document).on('click', '#header-login-btn', function(e) {\r\n\t\tvar modal = new Modal('Login');\r\n        var changeEmailForm = '<login-form></login-form>';\r\n        modal.setVue(changeEmailForm);\r\n\t\tmodal.setVisible(true);\r\n        modal.toolbarEl.remove();\r\n\r\n\t\tdocument.addEventListener('logged-in', function(e) {\r\n\t\t\tmodal.destroy();\r\n\t\t});\r\n\t});\r\n\r\n\t// handle login form submit\r\n    $(document).on('submit', '#login_form', function(e) {\r\n        e.preventDefault();\r\n\r\n        var formData = $(this).serialize();\r\n\r\n\t\t$(this).hide();\r\n\r\n\t\tvar loading = '<span id=\"loading5\"> <span id=\"outerCircle\"></span></span>';\r\n\t\t$(this).parent().append(loading);\r\n\r\n        var req = $.ajax({\r\n            type: \"POST\",\r\n            url: \"./user/login\",\r\n            data: formData,\r\n            dataType: \"json\",\r\n            context: this,\r\n            success: function (resp) {\r\n                if (resp.formCheck !== 'error') {\r\n                    ga('send', 'event', 'functions', 'login', 'login', '1'); // google analytics\r\n\r\n                    $(\"#header\").load(location.href + \" #header\", function() {\r\n                        document.dispatchEvent(new Event('logged-in'));\r\n\t\t\t\t\t});\r\n                }\r\n                else {\r\n                \t$('#loading5').remove();\r\n                \t$(this).show();\r\n                \t$(this).find('.login-error').text('Invalid login, please try again.').fadeIn(200);\r\n\t\t\t\t}\r\n            },\r\n            error: function (data) {\r\n\t\t\t\thandleError(data);\r\n            }\r\n        });\r\n\r\n        return false;\r\n    });\r\n\r\n\r\n});\r\n\r\n","// creates a modal component\r\n\r\nfunction Modal(title, content) {\r\n    this.title = title;\r\n    this.content = content;\r\n\r\n    // parseDOM should be a globally access thing\r\n    this.parseDOM();\r\n    this.create();\r\n};\r\n\r\nModal.prototype.parseDOM = function() {\r\n    this.body =  jQuery('body');\r\n};\r\n\r\nModal.prototype.create = function()\r\n{\r\n    this.maskEl = document.createElement('div');\r\n    this.maskEl.id = 'modal-mask';\r\n\r\n    this.containerEl = document.createElement('div');\r\n    this.containerEl.className = 'modal-container';\r\n\r\n    this.titleEl = document.createElement('div');\r\n    this.titleEl.className = 'modal-title';\r\n    this.titleEl.innerHTML = this.title;\r\n\r\n    this.contentEl = document.createElement('div');\r\n    this.contentEl.className = 'modal-content';\r\n\r\n    this.containerEl.addEventListener('keypress', function (e) {\r\n        var key = e.which || e.keyCode;\r\n        if (key === 13 && this.submitAction) { // enter key\r\n            this.executeSubmit();\r\n        }\r\n    }.bind(this));\r\n\r\n    this.toolbarEl = document.createElement('div');\r\n    this.toolbarEl.className = 'modal-toolbar';\r\n\r\n    this.submitButton = document.createElement('button');\r\n    this.submitButton.className = 'btn push-right';\r\n    this.submitButton.innerText = 'OK';\r\n\r\n    this.cancelButton = document.createElement('button');\r\n    this.cancelButton.className = 'btn btn-grey';\r\n    this.cancelButton.innerText = 'Cancel';\r\n    this.setCancelAction();\r\n\r\n    this.toolbarEl.appendChild(this.submitButton);\r\n    this.toolbarEl.appendChild(this.cancelButton);\r\n\r\n    jQuery(this.containerEl).append(this.titleEl);\r\n    jQuery(this.containerEl).append(this.contentEl);\r\n    jQuery(this.containerEl).append(this.toolbarEl);\r\n\r\n    // add dynamically created DOM elements to body\r\n    this.body.prepend(this.containerEl);\r\n    this.body.prepend(this.maskEl);\r\n\r\n    this.resize();\r\n\r\n    this.maskEl.addEventListener('click', function(e) {\r\n        this.destroy();\r\n    }.bind(this));\r\n};\r\n\r\nModal.prototype.resize = function() {\r\n    jQuery(this.containerEl).css(\"top\", 0.5 * $(window).height() - (jQuery(this.containerEl).height() / 2));\r\n};\r\n\r\nModal.prototype.setVisible = function() {\r\n    jQuery(this.maskEl).fadeIn(100);\r\n    jQuery(this.containerEl).fadeIn(100);\r\n};\r\n\r\nModal.prototype.destroy = function() {\r\n    this.maskEl.remove();\r\n    this.containerEl.remove();\r\n};\r\n\r\nModal.prototype.setTitle = function(title) {\r\n    this.title = title;\r\n    this.titleEl.innerHTML = title;\r\n};\r\n\r\nModal.prototype.setVue = function(shorthand) {\r\n    this.content = shorthand;\r\n    this.contentEl.innerHTML = shorthand;\r\n\r\n    const content = new Vue({\r\n        el: '.modal-content',\r\n        data: {\r\n            message: 'message here'\r\n        }\r\n    });\r\n    this.resize();\r\n};\r\n\r\n/*\r\n* For plain text or html\r\n* */\r\nModal.prototype.setContent = function(content) {\r\n    this.content = content;\r\n    this.contentEl.innerHTML = content;\r\n    this.resize();\r\n};\r\n\r\nModal.prototype.setSubmitAction = function(action) {\r\n    this.submitAction = action;\r\n    this.submitButton.addEventListener('click', function(e) {\r\n        this.executeSubmit();\r\n    }.bind(this));\r\n};\r\n\r\nModal.prototype.executeSubmit = function() {\r\n    this.submitAction();\r\n};\r\n\r\nModal.prototype.setCancelAction = function() {\r\n    this.cancelButton.addEventListener('click', function(e) {\r\n        this.destroy();\r\n    }.bind(this));\r\n};\r\n\r\nModal.prototype.setData = function(data) {\r\n    this.data = data;\r\n};\r\n\r\nModal.prototype.getElement = function(data) {\r\n    return this.containerEl;\r\n};\r\n\r\n\r\n","// Bias the autocomplete object to the user's geographical location,\r\n// as supplied by the browser's 'navigator.geolocation' object.\r\nwindow.geolocate_ = function(autocomplete) {\r\n    if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(function(position) {\r\n            var geolocation = {\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude\r\n            };\r\n            var circle = new google.maps.Circle({\r\n                center: geolocation,\r\n                radius: position.coords.accuracy\r\n            });\r\n            autocomplete.setBounds(circle.getBounds());\r\n        });\r\n    }\r\n};\r\n\r\n// Bias the autocomplete object to the user's geographical location,\r\n// as supplied by the browser's 'navigator.geolocation' object.\r\nfunction geolocate() {\r\n    if (navigator.geolocation) {\r\n        navigator.geolocation.getCurrentPosition(function(position) {\r\n            var geolocation = {\r\n                lat: position.coords.latitude,\r\n                lng: position.coords.longitude\r\n            };\r\n            var circle = new google.maps.Circle({\r\n                center: geolocation,\r\n                radius: position.coords.accuracy\r\n            });\r\n            autocomplete.setBounds(circle.getBounds());\r\n        });\r\n    }\r\n}\r\n\r\nwindow.initAutocomplete = function() {\r\n    // Create the autocomplete object, restricting the search to geographical\r\n    // location types.\r\n\r\n    if (document.getElementById('address-street')) {\r\n        autocomplete = new google.maps.places.Autocomplete(\r\n            /** @type {!HTMLInputElement} */(document.getElementById('address-street')),\r\n            {types: ['geocode']});\r\n\r\n        // When the user selects an address from the dropdown, populate the address\r\n        // fields in the form.\r\n        autocomplete.addListener('place_changed', fillInAddress);\r\n        geolocate();\r\n    }\r\n};\r\n"]}